<html>
<head>
  <title>BMZCTF Misc 10（57-60）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603279 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3378"/>
<h1>BMZCTF Misc 10（57-60）</h1>

<div>
<span><div><span style="font-weight: bold;">57 BJDCTF-2020-Misc-你猜我是个啥</span></div><div><br/></div><div>下载得到zip格式文件。但是打不开，因为它其实是个PNG图片。重命名得到二维码：</div><div><img src="BMZCTF Misc 10（57-60）_files/1.png" type="image/png" data-filename="1.png"/></div><div>但扫码没有得到flag。</div><div><br/></div><div>再次十六进制编辑器打开，文件末尾有字符串形式的flag。</div><div><img src="BMZCTF Misc 10（57-60）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：flag{i_am_fl@g}</div><div><br/></div><div><span style="font-weight: bold;">58 penpig</span></div><div><br/></div><div>下载得到jpg格式文件。打开看一下：</div><div><img src="BMZCTF Misc 10（57-60）_files/kiss.jpg" type="image/jpeg" data-filename="kiss.jpg"/></div><div>很明显是猪圈密码，替换表为：</div><div><img src="BMZCTF Misc 10（57-60）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>一一对应转码得到：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>flag{yyyyy_ywww@}</div></div><div><br/></div><div>flag：flag{yyyyy_ywww@}</div><div><br/></div><div><span style="font-weight: bold;">59 suspicion</span></div><div><br/></div><div>下载得到mem.vmem和无扩展名文件suspicion。后者暂时看不出是什么文件，先看前者，上volatility：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# volatility -f mem.vmem imageinfo</div><div>Volatility Foundation Volatility Framework 2.6</div><div>INFO    : volatility.debug    : Determining profile based on KDBG search...</div><div>          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)</div><div>                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)</div><div>                     AS Layer2 : FileAddressSpace (/root/Desktop/mem.vmem)</div><div>                      PAE type : PAE</div><div>                           DTB : 0xb18000L</div><div>                          KDBG : 0x80546ae0L</div><div>          Number of Processors : 1</div><div>     Image Type (Service Pack) : 3</div><div>                KPCR for CPU 0 : 0xffdff000L</div><div>             KUSER_SHARED_DATA : 0xffdf0000L</div><div>           Image date and time : 2016-05-03 04:41:19 UTC+0000</div><div>     Image local date and time : 2016-05-03 12:41:19 +0800</div></div><div>查看进程列表：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@kali:~/Desktop# volatility -f mem.vmem --profile=WinXPSP2x86 pslist</div><div>Volatility Foundation Volatility Framework 2.6</div><div>Offset(V)  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          </div><div>---------- -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------</div><div>0x821b9830 System                    4      0     62      253 ------      0                                                              </div><div>0x81fb9210 smss.exe                552      4      3       19 ------      0 2016-05-03 04:32:10 UTC+0000                                 </div><div>0x81c14da0 csrss.exe               616    552     10      328      0      0 2016-05-03 04:32:12 UTC+0000                                 </div><div>0x81f81880 winlogon.exe            640    552     18      449      0      0 2016-05-03 04:32:12 UTC+0000                                 </div><div>0x8208fda0 services.exe            684    640     16      260      0      0 2016-05-03 04:32:12 UTC+0000                                 </div><div>0x81c32b10 lsass.exe               696    640     18      333      0      0 2016-05-03 04:32:12 UTC+0000                                 </div><div>0x820a19a0 vmacthlp.exe            852    684      1       25      0      0 2016-05-03 04:32:13 UTC+0000                                 </div><div>0x81c30458 svchost.exe             864    684     18      201      0      0 2016-05-03 04:32:13 UTC+0000                                 </div><div>0x81c67020 svchost.exe             948    684     11      238      0      0 2016-05-03 04:32:13 UTC+0000                                 </div><div>0x81ce7da0 svchost.exe            1040    684     55     1103      0      0 2016-05-03 04:32:13 UTC+0000                                 </div><div>0x81c25020 svchost.exe            1096    684      4       66      0      0 2016-05-03 04:32:13 UTC+0000                                 </div><div>0x82002b28 svchost.exe            1256    684     13      194      0      0 2016-05-03 04:32:14 UTC+0000                                 </div><div>0x81f6c988 explorer.exe           1464   1448     12      329      0      0 2016-05-03 04:32:14 UTC+0000                                 </div><div>0x82085550 spoolsv.exe            1576    684     13      140      0      0 2016-05-03 04:32:14 UTC+0000                                 </div><div>0x81f64560 vmtoolsd.exe           1712   1464      5      145      0      0 2016-05-03 04:32:15 UTC+0000                                 </div><div>0x820a3528 ctfmon.exe             1736   1464      1       78      0      0 2016-05-03 04:32:15 UTC+0000                                 </div><div>0x81f7d3c0 vmtoolsd.exe           2020    684      7      273      0      0 2016-05-03 04:32:23 UTC+0000                                 </div><div>0x8207db28 TPAutoConnSvc.e         512    684      5       99      0      0 2016-05-03 04:32:25 UTC+0000                                 </div><div>0x81c26da0 alg.exe                1212    684      6      105      0      0 2016-05-03 04:32:26 UTC+0000                                 </div><div>0x81f715c0 wscntfy.exe            1392   1040      1       39      0      0 2016-05-03 04:32:26 UTC+0000                                 </div><div>0x81e1f520 TPAutoConnect.e        1972    512      1       72      0      0 2016-05-03 04:32:26 UTC+0000                                 </div><div>0x81f9d3e8 TrueCrypt.exe          2012   1464      2      139      0      0 2016-05-03 04:33:36 UTC+0000   </div></div><div>比较可疑的是TrueCrypt.exe，这是一款磁盘加密工具。猜测suspicion可能是加密结果，那么关键就是从内存镜像中找到对应的解密密钥。用Passware Kit：</div><div><img src="BMZCTF Misc 10（57-60）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>得到解密后的文件：</div><div><img src="BMZCTF Misc 10（57-60）_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>直接用7-Zip打开解密后的镜像得到flag：</div><div><img src="BMZCTF Misc 10（57-60）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>flag：PCTF{T2reCrypt_15_N07_S3cu2e}</div><div><br/></div><div><span style="font-weight: bold;">60 山东省大学生网络技术大赛-morse</span></div><div><br/></div><div>下载得到wav格式文件，audacity打开：</div><div><img src="BMZCTF Misc 10（57-60）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>上方声道有明显的摩斯电码波形，记录如下：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>..... -... -.-. ----. ..--- ..... -.... ....- ----. -.-. -... ----- .---- ---.. ---.. ..-. ..... ..--- . -.... .---- --... -.. --... ----- ----. ..--- ----. .---- ----. .---- -.-.</div></div><div>摩斯电码转码：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>5BC925649CB0188F52E617D70929191C</div></div><div><br/></div><div>flag：flag{5BC925649CB0188F52E617D70929191C}</div></span>
</div></body></html> 